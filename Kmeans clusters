import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import datetime as dt
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
import seaborn as sns

df = pd.read_csv('sales_data_sample.csv', encoding='unicode_escape')

import pandas as pd
# Read the Dataset
dataframe = pd.read_csv("sales_data_sample.csv")

df.info()
# Drop the Unnecessary Columns
df = df[['ORDERLINENUMBER', 'SALES']]

df.info()

df.isna().sum()

from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaled_values = scaler.fit_transform(df.values)

# This tries to make the Mean 0 and the Standard Deviation as 1

# Import KMeansClustering

from sklearn.cluster import KMeans

# Finding k with the Elbow Method

# Within Cluster Sum of Squares of Distances
wcss = [] 

for i in range(1,11):
    model = KMeans(n_clusters=i)
    model.fit_predict(scaled_values)
    wcss.append(model.inertia_)

# The inertia is computed as the sum of squared distances from each data point to the center of its assigned cluster 

# Plot the Elbow Plot
import matplotlib.pyplot as plt

plt.plot(range(1,11),wcss,'ro-')
plt.show()

kmeans_model = KMeans(n_clusters=7)

cluster = kmeans_model.fit_predict(scaled_values)

import warnings
warnings.filterwarnings('ignore')
df['Cluster'] = cluster

plt.scatter(df['ORDERLINENUMBER'], df['SALES'],c=df['Cluster'])

